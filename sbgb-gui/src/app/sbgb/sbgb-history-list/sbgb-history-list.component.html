@if (visibleBases.length === 0) {
  <div class="empty-state">
    <mat-icon>inbox</mat-icon>
    <p>Aucun ciel étoilé enregistré.</p>
  </div>
} @else {
  <mat-accordion multi>
    @for (base of visibleBases; track base.id) {
      <mat-expansion-panel (opened)="onBaseExpanded(base.id)">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <span class="base-description">{{ base.description }}</span>
          </mat-panel-title>
          <mat-panel-description>
            <span class="base-max-note">
              @for (star of starValues; track star) {
                <mat-icon class="star-icon" [class.filled]="isFilled(star, base.maxNote)">
                  {{ isFilled(star, base.maxNote) ? 'star' : 'star_border' }}
                </mat-icon>
              }
            </span>
          </mat-panel-description>
        </mat-expansion-panel-header>

        <div class="renders-grid">
          @for (render of rendersFor(base.id); track render.id) {
            <div class="render-card" (click)="onRenderSelected(render)" matTooltip="{{ render.description }}">
              @if (render.thumbnail) {
                <img class="render-thumbnail"
                     [src]="'data:image/png;base64,' + render.thumbnail"
                     [alt]="render.description" />
              } @else {
                <div class="render-thumbnail placeholder">
                  <mat-icon>image</mat-icon>
                </div>
              }
              <div class="render-footer">
                <span class="render-note">
                  @for (star of starValues; track star) {
                    <mat-icon class="star-icon small" [class.filled]="isFilled(star, render.note)">
                      {{ isFilled(star, render.note) ? 'star' : 'star_border' }}
                    </mat-icon>
                  }
                </span>
                <button mat-icon-button
                        (click)="onDeleteRender(render.id); $event.stopPropagation()"
                        matTooltip="Supprimer ce rendu"
                        class="delete-btn">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </div>
          }
        </div>
      </mat-expansion-panel>
    }
  </mat-accordion>
}
